View(df_drive_sentiment)
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
df_drive_rating <- DriverAnalysis %>%
group_by(SemiSupervised) %>%
summarise(Media_sentiment = mean(score_rating))
rm(df_drive_tab)
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_tab)
rm(df_drive_rating)
df_drive_rating <- DriverAnalysis %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating))
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_rating)
rm(df_drive_tab)
df_drive_rating <- DriverAnalysis %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_tab)
rm(df_drive_rating)
df_drive_rating <- DriverAnalysis %>%
filter(Social == "places") %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
df_drive_rating <- DriverAnalysis %>%
filter(Social == "places") %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
rm(df_drive_rating)
rm(df_drive_tab)
View(DriverAnalysis)
df_drive_rating <- DriverAnalysis %>%
filter(social == "places") %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- left_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
left_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_tab)
rm(df_drive_rating)
df_drive_rating <- DriverAnalysis %>%
filter(social == "twitter") %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- full_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
full_join(df_drive_rating, by = "SemiSupervised") %>%
full_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_rating)
rm(df_drive_tab)
df_drive_rating <- DriverAnalysis %>%
filter(social == "twitter") %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- full_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
right_join(df_drive_rating, by = "SemiSupervised") %>%
full_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_tab)
df_drive_tab <- full_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
left_join(df_drive_rating, by = "SemiSupervised") %>%
full_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_rating)
df_drive_rating <- DriverAnalysis %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- full_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
full_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
rm(df_drive_tab)
rm(df_drive_rating)
df_drive_rating <- DriverAnalysis %>%
group_by(SemiSupervised) %>%
summarise(Media_rating = mean(score_rating, na.rm = TRUE))
df_drive_tab <- full_join(DriverAnalysis, df_drive_sentiment, by = "SemiSupervised") %>%
full_join(df_drive_rating, by = "SemiSupervised") %>%
full_join(df_drive_recensioni, by = "SemiSupervised")
View(df_drive_tab)
View(df_drive_tab)
rm(df_drive_rating)
rm(df_drive_recensioni)
rm(df_drive_tab)
rm(df_drive_sentiment)
View(Df_sentiment)
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
Media_sentiment = round(mean(sentimentAnalysis),2))
library(readxl)
library(writexl)
# Directory
library(rstudioapi)
# Pre-processing
library(quanteda)
library(quanteda.textstats)
library(SnowballC) # stemming delle keywords
# Driver Analysis
library(dplyr)
library(syuzhet)
library(newsmap)
# Algoritmi
library(naivebayes)
library(randomForest)
library(iml)
library(future)
library(future.callr)
library(e1071)
library(reshape2)
library(cvTools)
library(caret)
# Grafici
library(ggplot2)
library(gridExtra)
library(quanteda.textplots)
library(kableExtra)
library(flextable)
library(officer)
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
Media_sentiment = round(mean(sentimentAnalysis),2))
View(Generale)
Generale |>
bg(j = "media_rating",
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL)) |>
add_footer_lines("God help us. R is not that nice. Almost as bad as SQL")
Generale <- flextable(head(flex_table_stores)) |>
bold(part = "header")
Generale |>
bg(j = "media_rating",
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL)) |>
add_footer_lines("God help us. R is not that nice. Almost as bad as SQL")
rm(Generale)
# TABELLA GENERALE
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
Media_sentiment = round(mean(sentimentAnalysis),2))
set_flextable_defaults(
font.family = "Arial", font.size = 10,
border.color = "gray", big.mark = "")
Generale_ft <- flextable(Generale)
Generale_ft |>
bg(j = "media_rating",
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL)) |>
add_footer_lines("God help us. R is not that nice. Almost as bad as SQL")
Generale_ft |>
bg(j = "media_rating",
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
Generale_ft |>
bg(j = c("media_rating","Media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
rm(Generale)
rm(Generale_ft)
# TABELLA GENERALE
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
set_flextable_defaults(
font.family = "Arial", font.size = 10,
border.color = "gray", big.mark = "")
Generale_ft <- flextable(Generale)
Generale_ft |>
bg(j = c("media_rating","Media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
View(Generale)
for (i in levels(DriverAnalysis$SemiSupervised)){
df_i <- DriverAnalysis %>%
filter(SemiSupervised == i)
summary_i <- final_df_i %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
Generale <- inner_join(Generale,summary_i,
by = "Player")
}
for (i in levels(DriverAnalysis$SemiSupervised)){
df_i <- DriverAnalysis %>%
filter(SemiSupervised == i)
summary_i <- df_i %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
Generale <- inner_join(Generale,summary_i,
by = "Player")
}
# Modifico i nomi delle colonne per renderli più leggibili ed uniformarli
names(Generale) <- c("Player", rep(c("Numero reviews","Media score","Media sentiment"),
length(levels(DriverAnalysis$SemiSupervised))+1))
View(Generale)
Generale_ft2 <- flextable(Generale)
View(EmotionAnalysis)
View(DriverAnalysis)
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
et_flextable_defaults(
font.family = "Arial", font.size = 10,
border.color = "gray", big.mark = "")
Generale_ft <- flextable(Generale)
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
for (i in levels(DriverAnalysis$SemiSupervised)){
df_i <- DriverAnalysis %>%
filter(SemiSupervised == i)
summary_i <- df_i %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
Generale <- inner_join(Generale,summary_i,
by = "Player")
}
View(Generale_ft)
View(Generale)
# Modifico i nomi delle colonne per renderli più leggibili ed uniformarli
names(Generale) <- c("Player", rep(c("Numero reviews","Media score","Media sentiment"),
length(levels(DriverAnalysis$SemiSupervised))+1))
View(Generale)
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c("" = 1, "Prezzo" = 2,"Servizio" = 3,"Ordini" = 4,"Location" = 5))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c("Brand" = 1, "Prezzo" = 2,"Servizio" = 3,"Ordini" = 4,"Location" = 5))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c("Prezzo" = 2,"Servizio" = 3,"Ordini" = 4,"Location" = 5))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c("" = 1,"Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c(" " = 1,"Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
# TABELLA DRIVER SENTIMENT
levels(DriverAnalysis$SemiSupervised)
add_header_above(c(" " = 1,"Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3, "Test" = 3)
kbl(Generale) %>%
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c(" " = 1,"Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3, "Test" = 3))
# TABELLA DRIVER RATING
Generale <- DriverAnalysis %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
Generale_ft <- flextable(Generale)
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
for (i in levels(DriverAnalysis$SemiSupervised)){
df_i <- DriverAnalysis %>%
filter(SemiSupervised == i)
summary_i <- df_i %>%
group_by(Player) %>%
summarise(n_rev = length(text),
media_rating = round(mean(score_rating,na.rm = TRUE),2),
media_sentiment = round(mean(sentimentAnalysis),2))
Generale <- inner_join(Generale,summary_i,
by = "Player")
}
# Modifico i nomi delle colonne per renderli più leggibili ed uniformarli
names(Generale) <- c("Player", rep(c("Numero reviews","Media score","Media sentiment"),
length(levels(DriverAnalysis$SemiSupervised))+1))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3, "Test" = 3))
kbl(Generale) %>%
kable_classic() %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`), end = 0.7) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`, end = 0.7)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`, end = 2)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`, end = 0.2)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`, end =1)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4, color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(4:8, color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4:6, 8:10), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(3:4, 6:7, 9:10, 12:13), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(3:4, 6:7, 9:10, 12:13, 15:16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
Generale %>%
kbl() %>%
column_spec(c(3:4, 6:7, 9:10, 12:13, 15:16), color = "white",
background = ifelse(Generale$`Media sentiment` < 0.33, "red",
ifelse(Generale$`Media sentiment` < 0.66, "yellow", "green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(3:4, 6:7, 9:10, 12:13, 15:16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(Generale$`Media sentiment`, color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9)) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
help("spec_color")
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, scale_from = c("red","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","yellow","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","wheat","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9)) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.9, palette = c("red", "orange","green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =0.9, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =1, palette = c("red", "orange","green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
help("spec_color")
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =1, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =1, palette = c("red", "orange","green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =1, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =0.2, palette = c("red", "orange","green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
Generale_ft |>
bg(j = c("media_rating","media_sentiment"),
bg = scales::col_quantile(palette = c("wheat", "red"), domain =NULL))
# TABELLA DRIVER RATING
kbl(Generale) %>%
kable_classic() %>%
column_spec(c(4,7,10,13,16), color = "white",
background = spec_color(Generale$`Media sentiment`, end =1, palette = c("red","orange","green"))) %>%
column_spec(c(3,6,9,12,15), color = "white",
background = spec_color(Generale$`Media score`, end =1, palette = c("red", "orange","green"))) %>%
add_header_above(c(" " = 1," Generale" = 3, "Prezzo" = 3,"Servizio" = 3,"Ordini" = 3,"Location" = 3))
ggplot(Brand_sentiment,aes(x = Brand, y = Freq, fill = Sentiment))+
geom_bar(position="stack",stat="identity") +
scale_fill_manual(values = c("#993333", "grey", "darkseagreen")) +
labs(title = "Come varia il sentiment nei diversi brand?") +
coord_flip() +
ylab(label="Valori assoluti") +
xlab("") +
#la legenda viene generata in modo automatico
guides(fill=guide_legend(title="Sentiment")) +
theme(plot.title = element_text(color = "black", size = 12, face = "bold"),
plot.subtitle = element_text(face = "plain"),
axis.title=element_text(size=10,face="plain"),
axis.text= element_text(size =10, face = "italic"),
axis.text.x = element_text(color="#993333", angle=45))
ggplot(Brand_rating,aes(x = Brand, y = Freq, fill = Rating))+
geom_bar(position="dodge",stat="identity") +
scale_fill_manual(values = c("#993333", "#FF5733", "#FFC300", "#DAF7A6", "#7FFF00")) +
labs(title = "Come varia il rating nei diversi brand?") +
#rappresentiamo le barre in orizzontale (inverte gli assi)
#coord_flip() +
ylab(label="Valori assoluti") +
xlab("") +
#la legenda viene generata in modo automatico
guides(fill=guide_legend(title="Rating")) +
theme(plot.title = element_text(color = "black", size = 12, face = "bold"),
plot.subtitle = element_text(face = "plain"),
axis.title=element_text(size=10,face="plain"),
axis.text= element_text(size =10, face = "italic"),
axis.text.x = element_text(color="#993333", angle=45))
# Creazione di un grafico a matrice di confusione
heatmap(cross_tab, col = colorRampPalette(c("blue", "white", "red"))(256), main = "Matrice di confusione tra Sentiment e Rating")
ggplot(Mediaworld_driver,aes(x = Driver, y = Freq, fill = Sentiment))+
geom_bar(position="stack",stat="identity") +
scale_fill_manual(values = c("#993333", "darkseagreen")) +
labs(title = "Mediaworld",
subtitle = "Come varia il sentiment nei diversi driver?") +
ylab(label="Valori assoluti") +
xlab("") +
#la legenda viene generata in modo automatico
guides(fill=guide_legend(title="Sentiment")) +
theme(plot.title = element_text(color = "black", size = 12, face = "bold"),
plot.subtitle = element_text(face = "plain"),
axis.title=element_text(size=10,face="plain"),
axis.text= element_text(size =10, face = "italic"),
axis.text.x = element_text(color="#993333", angle=45))
rm(Euronics_grafico)
rm(Unieuro_grafico)
rm(Mediaworld_grafico)
